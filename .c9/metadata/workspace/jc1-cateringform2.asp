{"filter":false,"title":"jc1-cateringform2.asp","tooltip":"/jc1-cateringform2.asp","undoManager":{"mark":19,"position":19,"stack":[[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":67,"column":0},"end":{"row":71,"column":0}},"nl":"\n","lines":["for I = 1 to 23","\texecute(\"amt\" & cstr(I) & \" = cint(request.form(\" & chr(34) & \"amt\" & cstr(I) & chr(34) & \"))\")","next ",""]}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":119,"column":0},"end":{"row":119,"column":15}},"text":"for I = 1 to 23"},{"action":"insertText","range":{"start":{"row":119,"column":15},"end":{"row":120,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":120,"column":0},"end":{"row":123,"column":0}},"lines":["\texecute(\"amt\" & cstr(I) & \" = cint(request.form(\" & chr(34) & \"amt\" & cstr(I) & chr(34) & \"))\")","next ",""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":120,"column":0},"end":{"row":121,"column":0}},"nl":"\n","lines":["\texecute(\"amt\" & cstr(I) & \" = cint(request.form(\" & chr(34) & \"amt\" & cstr(I) & chr(34) & \"))\")"]}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":116,"column":0},"end":{"row":117,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":116,"column":0},"end":{"row":116,"column":96}},"text":"\texecute(\"amt\" & cstr(I) & \" = cint(request.form(\" & chr(34) & \"amt\" & cstr(I) & chr(34) & \"))\")"},{"action":"insertText","range":{"start":{"row":116,"column":96},"end":{"row":117,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":117,"column":0},"end":{"row":118,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":121,"column":0},"end":{"row":125,"column":0}},"nl":"\n","lines":["next ","","",""]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":120,"column":0},"end":{"row":120,"column":15}},"text":"for I = 1 to 23"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":117,"column":1},"end":{"row":117,"column":2}},"text":"E"},{"action":"insertText","range":{"start":{"row":117,"column":1},"end":{"row":117,"column":2}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":117,"column":1},"end":{"row":117,"column":8}},"text":"execute"},{"action":"insertText","range":{"start":{"row":117,"column":1},"end":{"row":117,"column":8}},"text":"execute"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":118,"column":1},"end":{"row":118,"column":2}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":118,"column":1},"end":{"row":118,"column":2}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":242,"column":28},"end":{"row":243,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":243,"column":0},"end":{"row":243,"column":1}},"text":"\t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":230,"column":0},"end":{"row":230,"column":25}},"text":"objPrinter.Write(PrnBody)"},{"action":"insertText","range":{"start":{"row":230,"column":25},"end":{"row":231,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":229,"column":0},"end":{"row":229,"column":1}},"text":"'"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":230,"column":19},"end":{"row":230,"column":20}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":230,"column":18},"end":{"row":230,"column":19}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":230,"column":17},"end":{"row":230,"column":18}},"text":"P"}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":0,"column":0},"end":{"row":261,"column":0}},"nl":"\n","lines":["<% ","Option Explicit","","Dim I","Dim EmailFrom, EmailTo, Subject","Dim printer","Dim name, email, rdate, deptchargecode, grandtotal","Dim rtime, attendees, location, groupname, setuptype, notes","Dim amt1, amt2, amt3, amt4, amt5","Dim amt6, amt7, amt8, amt9, amt10","Dim amt11, amt12, amt13, amt14, amt15","Dim amt16, amt17, amt18, amt19, amt20","Dim amt21, amt22, amt23","","Dim desc1, desc2, desc3, desc4, desc5","Dim desc6, desc7, desc8, desc9, desc10","Dim desc11, desc12, desc13, desc14, desc15","Dim desc16, desc17, desc18, desc19, desc20","Dim desc21, desc22, desc23","Dim nbsp","","","Dim price1, price2, price3, price4, price5","Dim price6, price7, price8, price9, price10","Dim price11, price12, price13, price14, price15","Dim price16, price17, price18, price19, price20","Dim price21, price22, price23","Dim total1, total2, total3, total4, total5","Dim total6, total7, total8, total9, total10","Dim total11, total12, total13, total14, total15","Dim total16, total17, total18, total19, total20","Dim total21, total22, total23, pipe","Dim Body, PrnBody","Dim br, tr, td, ctr, ctd","Dim strUsername, strPassword","Dim objFS, objWSHNet, objPrinter","Dim mail","","'printer = \"\\\\KVCHPRINT\\FNS-PR1\"","printer = \"\\\\mis-06\\jasonpdf\"","strUsername = \"kvch\\jcathcart\"","strPassword = \"5531Mkie6425\"","","pipe=\" | \"","nbsp = \"&nbsp;\"","br = \"<br>\"","td = \"<td>\"","ctd = \"&nbsp;</td>\"","tr = \"<tr>\"","ctr =\"</tr>\"","","'get data from form","name = request.form(trim(\"name\"))","email = request.form(trim(\"email\"))","emailFrom = email","emailTo = \"jcathcart@kvhealthcare.org\"","'EmailTo = email & \"; mhanson@kvhealthcare.org\"","Subject = \"Catering Request\"","rtime = request.form(trim(\"time\"))","rdate = request.form(trim(\"date\"))","attendees = request.form(trim(\"attendees\"))","groupname = request.form(trim(\"groupname\"))","location = request.form(trim(\"location\"))","setuptype = request.form(trim(\"setuptype\"))","deptchargecode = request.form(trim(\"deptchargecode\"))","notes = request.form(trim(\"notes\"))","","price1 = .08","price2 = .05","price3 = .08","price4 = 2.65","price5 = 1.45","price6 = 5.90","price7 = 8.60","price8 = 2.10","price9 = 1.25","price10 = .55","price11 = 1.40","price12 = 1.40","price13 = 1.15","price14 = .85","price15 = 1.05","price16 = .85","price17 = 8.30","price18 = 63","price19 = 31.50","price20 = 46.20","price21 = 23.10","price22 = .50","price23 = .40","","desc1 = \"12 oz. dixie coffee cups, each\"","desc2 = \"Napkin, each\"","desc3 = \"Plasticware, each\"","desc4 = \"Tablecloth, disposable, each\"","desc5 = \"20 oz. Bottled Beverages (Tea, Juice, Soda, Water)\"","desc6 = \"Pitcher Fruit Punch, serves 10\"","desc7 = \"Pump Pot Coffee (Reg or Decaf + coffee condiments)\"","desc8 = \"Pump Pot Hot Water (includes tea bags, cocoa packets)\"","desc9 = \"Cheese slice, packaged, each\"","desc10 = \"Yogurt, 6 oz.\"","desc11 = \"Bagels, each, sliced (includes cream cheese portion pkt)\"","desc12 = \"Danish\"","desc13 = \"Cinnamon Roll, each\"","desc14 = \"Cookies, brownies, bars, each\"","desc15 = \"Cookies, specialty, holiday (specify)\"","desc16 = \"Fresh muffin, each\"","desc17 = \"Box Lunch, each\"","desc18 = \"Meat/Cheese Tray,Large ( 35- 40 servings)\"","desc19 = \"Meat/Cheese Tray,Small (15- 20 servings)\"","desc20 = \"Veg or Fruit Tray, Large ( 35- 40 servings)\"","desc21 = \"Veg or Fruit Tray, small (15-25 servings)\"","desc22 = \"Ice Cream, 4 oz.\"","desc23 = \"Sherbet, 4 oz.\"","","For I = 1 to 23","\texecute(\"amt\" & cstr(I) & \" = cint(request.form(\" & chr(34) & \"amt\" & cstr(I) & chr(34) & \"))\")","\texecute(\"total\"& I &\" = amt\" & I & \" * price\" & I)","\texecute(\"grandtotal = grandtotal + total\" & I)","next","","","if (name = \"\") or (rdate = \"\") or (email = \"\") or (deptchargecode = \"\") or (rtime = \"\") or (attendees = \"\") or (groupname = \"\") or (location = \"\") or (setuptype = \"\") then","\tResponse.Write \"<p>We are sorry but there seems to be an error in the form. Please click back on your browser and complete the following field(s) : </p>\" ","\tif (name<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Name is blank.</font><br>\"","\tend if","\tif (rtime<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Time is blank.</font><br>\"","\tend if","\tif (attendees<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Attendees is blank.</font><br>\"","\tend if","","\tif (groupname<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Group name is blank.</font><br>\"","\tend if","","\tif (location<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Location is blank.</font><br>\"","\tend if","\t","\tif (setuptype<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Setup type is blank.</font><br>\"","\tend if","","\tif (rdate<>\"\") Then","\tELSE","\tResponse.Write \"<font color='red'>� Date has been left blank.</font><br>\"","\tend if","\tif (email<>\"\") Then","\tELSE","\tResponse.Write \"<font color='red'>� Email address is blank.</font><br>\"","\tend if","\tif (deptchargecode<>\"\") Then","\tELSE","\tResponse.Write \"<font color='red'>� Department Charge code is blank.</font><br>\"","\tend if","end if","","' prepare email body text","","Body = Body & \"Requestor name: \" & name & br ","Body = Body & \"Requestor email: \" & email & br ","Body = Body & \"Event Date: \" & rdate & br ","Body = Body & \"Event Time: \" & rtime & br ","Body = Body & \"Attendees: \" & attendees & br","Body = Body & \"Group name: \" & groupname & br","Body = Body & \"Location: \" & location & br","Body = Body & \"Setup type: \" & setuptype & br & br","Body = Body & \"Department Charge Code: \" & deptchargecode & br & br","Body = Body & \"Notes: \" & replace(notes,chr(13),\"<br>\") & br & br","Body = Body & \"<table border='0' cellpadding='0' cellspacing='0'>\" & br","Body = Body & tr & td & \"Item &nbsp;\" & ctd & td & \"Cost &nbsp;\" & ctd & td & \"Amount &nbsp;\" & ctd & td & \"Subtotal &nbsp;\" & ctd & ctr","For I = 1 to 23","\tif eval(\"amt\" & cstr(i) &\" > 0\") then","\t\texecute(\"Body = Body & tr & td & desc\" & cstr(i) & \" & nbsp & ctd\")","\t\texecute(\"Body = Body & td & price\" & cstr(i) & \" & ctd\")","\t\texecute(\"Body = Body & td & amt\" & cstr(i) & \" & ctd\")","\t\texecute(\"Body = Body & td & formatnumber(total\" & cstr(i) & \",2) & ctd & ctr\")","\tend if ","Next","Body = Body & \"</table>\" & br","Body = Body & \"Grand total = \" & formatnumber(grandtotal,2) & br","","'prepare printed body test","","PrnBody = PrnBody & \"Catering Request \" & Vbcrlf & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Requestor name: \" & name & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Requestor email: \" & email & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Event Date: \" & rdate & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Event Time: \" & rtime & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Attendees: \" & attendees & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Group Name: \" & groupname & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Location: \" & location & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Setup type: \" & setuptype & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Department Charge Code: \" & deptchargecode & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Notes: \" & notes & Vbcrlf & Vbcrlf ","","For I = 1 to 23","\tif eval(\"amt\" &cstr(i)&\" > 0\") then","\t\tif eval(\"amt\" &cstr(i)&\" < 10\") then","\t\t\tExecute(\"PrnBody = PrnBody & \" & chr(34) & \"Quantity = 0\" & chr(34) & \" & amt\" & cstr(i) & \" & pipe\")","\t\telse","\t\t\tExecute(\"PrnBody = PrnBody & \" & chr(34) & \"Quantity = \"  & chr(34) & \" & amt\" & cstr(i) & \" & pipe\")\t\t","\t\tend if","\t\tExecute(\"PrnBody = PrnBody & desc\" & cstr(i) & \" & VbCrLf & VbCrLf\")","\t\t' PrnBody = PrnBody & \"Subtotal = \" & formatnumber(total1,2)  & VbCrLf & VbCrLf","\tend if","next","","PrnBody = PrnBody & VbCrLf & \"Total = $\" & formatnumber(grandtotal,2) & VbCrLf","","' Create FileSystem Object and Windows Script Host Network Object","'On Error Resume Next","","Set objFS = CreateObject(\"Scripting.FileSystemObject\")","Set objWSHNet = CreateObject(\"WScript.Network\")","","on error resume next","objWSHNet.RemovePrinterConnection \"LPT1:\"","objWSHNet.AddPrinterConnection \"LPT1:\", printer, False, strUsername, strPassword","Set objPrinter = objFS.CreateTextFile(\"LPT1:\", True)","'objPrinter.Write(PrnBody)","objPrinter.Write(Body)","Response.Write \"<br><font size='5'>Your catering order has been submitted and sent to the printer.</font><br>\"","","","' send email ","","if (name<>\"\") AND (rdate<>\"\") AND (email<>\"\") AND (deptchargecode<>\"\") THEN","\tSet mail = Server.CreateObject(\"CDO.Message\") ","\tmail.To = EmailTo","\tmail.From = EmailFrom","\tmail.Subject = Subject","\tmail.HTMLBody = Body","\tmail.Send()","\t' redirect to success page ","\t","\t' Close the print device object and trap for errors","\t'On Error Resume Next","\tobjPrinter.Close","\tobjWSHNet.RemovePrinterConnection \"LPT1:\"","\tSet objWSHNet  = Nothing","\tSet objFS      = Nothing","\tSet objPrinter = Nothing","","\tResponse.Write \"<br><font size='5'>An email containing your order has also been sent.</font><br>\"","ELSE","\tResponse.Write \"<br><font color='red' size='5'> Your catering order has not been submitted.</font><br>\"","end if","Response.Write br + Body","","%>",""]},{"action":"insertText","range":{"start":{"row":0,"column":0},"end":{"row":0,"column":3}},"text":"<% "},{"action":"insertText","range":{"start":{"row":0,"column":3},"end":{"row":1,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":1,"column":0},"end":{"row":261,"column":0}},"lines":["Option Explicit","","Dim I","Dim EmailFrom, EmailTo, Subject","Dim printer","Dim name, email, rdate, deptchargecode, grandtotal","Dim rtime, attendees, location, groupname, setuptype, notes","Dim amt1, amt2, amt3, amt4, amt5","Dim amt6, amt7, amt8, amt9, amt10","Dim amt11, amt12, amt13, amt14, amt15","Dim amt16, amt17, amt18, amt19, amt20","Dim amt21, amt22, amt23","","Dim desc1, desc2, desc3, desc4, desc5","Dim desc6, desc7, desc8, desc9, desc10","Dim desc11, desc12, desc13, desc14, desc15","Dim desc16, desc17, desc18, desc19, desc20","Dim desc21, desc22, desc23","Dim nbsp","","","Dim price1, price2, price3, price4, price5","Dim price6, price7, price8, price9, price10","Dim price11, price12, price13, price14, price15","Dim price16, price17, price18, price19, price20","Dim price21, price22, price23","Dim total1, total2, total3, total4, total5","Dim total6, total7, total8, total9, total10","Dim total11, total12, total13, total14, total15","Dim total16, total17, total18, total19, total20","Dim total21, total22, total23, pipe","Dim Body, PrnBody","Dim br, tr, td, ctr, ctd","Dim strUsername, strPassword","Dim objFS, objWSHNet, objPrinter","Dim mail","","'printer = \"\\\\KVCHPRINT\\FNS-PR1\"","printer = \"\\\\KVCHPRINT\\MIS-PR1\"","strUsername = \"kvch\\ttester\"","strPassword = \"ttester\"","","pipe=\" | \"","nbsp = \"&nbsp;\"","br = \"<br>\"","td = \"<td>\"","ctd = \"&nbsp;</td>\"","tr = \"<tr>\"","ctr =\"</tr>\"","","'get data from form","name = request.form(trim(\"name\"))","email = request.form(trim(\"email\"))","emailFrom = email","emailTo = \"jcathcart@kvhealthcare.org\"","'EmailTo = email & \"; mhanson@kvhealthcare.org\"","Subject = \"Catering Request\"","rtime = request.form(trim(\"time\"))","rdate = request.form(trim(\"date\"))","attendees = request.form(trim(\"attendees\"))","groupname = request.form(trim(\"groupname\"))","location = request.form(trim(\"location\"))","setuptype = request.form(trim(\"setuptype\"))","deptchargecode = request.form(trim(\"deptchargecode\"))","notes = request.form(trim(\"notes\"))","","price1 = .08","price2 = .05","price3 = .08","price4 = 2.65","price5 = 1.45","price6 = 5.90","price7 = 8.60","price8 = 2.10","price9 = 1.25","price10 = .55","price11 = 1.40","price12 = 1.40","price13 = 1.15","price14 = .85","price15 = 1.05","price16 = .85","price17 = 8.30","price18 = 63","price19 = 31.50","price20 = 46.20","price21 = 23.10","price22 = .50","price23 = .40","","desc1 = \"12 oz. dixie coffee cups, each\"","desc2 = \"Napkin, each\"","desc3 = \"Plasticware, each\"","desc4 = \"Tablecloth, disposable, each\"","desc5 = \"20 oz. Bottled Beverages (Tea, Juice, Soda, Water)\"","desc6 = \"Pitcher Fruit Punch, serves 10\"","desc7 = \"Pump Pot Coffee (Reg or Decaf + coffee condiments)\"","desc8 = \"Pump Pot Hot Water (includes tea bags, cocoa packets)\"","desc9 = \"Cheese slice, packaged, each\"","desc10 = \"Yogurt, 6 oz.\"","desc11 = \"Bagels, each, sliced (includes cream cheese portion pkt)\"","desc12 = \"Danish\"","desc13 = \"Cinnamon Roll, each\"","desc14 = \"Cookies, brownies, bars, each\"","desc15 = \"Cookies, specialty, holiday (specify)\"","desc16 = \"Fresh muffin, each\"","desc17 = \"Box Lunch, each\"","desc18 = \"Meat/Cheese Tray,Large ( 35- 40 servings)\"","desc19 = \"Meat/Cheese Tray,Small (15- 20 servings)\"","desc20 = \"Veg or Fruit Tray, Large ( 35- 40 servings)\"","desc21 = \"Veg or Fruit Tray, small (15-25 servings)\"","desc22 = \"Ice Cream, 4 oz.\"","desc23 = \"Sherbet, 4 oz.\"","","For I = 1 to 23","\texecute(\"amt\" & cstr(I) & \" = cint(request.form(\" & chr(34) & \"amt\" & cstr(I) & chr(34) & \"))\")","\texecute(\"total\"& I &\" = amt\" & I & \" * price\" & I)","\texecute(\"grandtotal = grandtotal + total\" & I)","next","","","if (name = \"\") or (rdate = \"\") or (email = \"\") or (deptchargecode = \"\") or (rtime = \"\") or (attendees = \"\") or (groupname = \"\") or (location = \"\") or (setuptype = \"\") then","\tResponse.Write \"<p>We are sorry but there seems to be an error in the form. Please click back on your browser and complete the following field(s) : </p>\" ","\tif (name<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Name is blank.</font><br>\"","\tend if","\tif (rtime<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Time is blank.</font><br>\"","\tend if","\tif (attendees<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Attendees is blank.</font><br>\"","\tend if","","\tif (groupname<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Group name is blank.</font><br>\"","\tend if","","\tif (location<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Location is blank.</font><br>\"","\tend if","\t","\tif (setuptype<>\"\") Then","\tElse","\tResponse.Write \"<font color='red'>� Setup type is blank.</font><br>\"","\tend if","","\tif (rdate<>\"\") Then","\tELSE","\tResponse.Write \"<font color='red'>� Date has been left blank.</font><br>\"","\tend if","\tif (email<>\"\") Then","\tELSE","\tResponse.Write \"<font color='red'>� Email address is blank.</font><br>\"","\tend if","\tif (deptchargecode<>\"\") Then","\tELSE","\tResponse.Write \"<font color='red'>� Department Charge code is blank.</font><br>\"","\tend if","end if","","' prepare email body text","","Body = Body & \"Requestor name: \" & name & br ","Body = Body & \"Requestor email: \" & email & br ","Body = Body & \"Event Date: \" & rdate & br ","Body = Body & \"Event Time: \" & rtime & br ","Body = Body & \"Attendees: \" & attendees & br","Body = Body & \"Group name: \" & groupname & br","Body = Body & \"Location: \" & location & br","Body = Body & \"Setup type: \" & setuptype & br & br","Body = Body & \"Department Charge Code: \" & deptchargecode & br & br","Body = Body & \"Notes: \" & replace(notes,chr(13),\"<br>\") & br & br","Body = Body & \"<table border='0' cellpadding='0' cellspacing='0'>\" & br","Body = Body & tr & td & \"Item &nbsp;\" & ctd & td & \"Cost &nbsp;\" & ctd & td & \"Amount &nbsp;\" & ctd & td & \"Subtotal &nbsp;\" & ctd & ctr","For I = 1 to 23","\tif eval(\"amt\" & cstr(i) &\" > 0\") then","\t\texecute(\"Body = Body & tr & td & desc\" & cstr(i) & \" & nbsp & ctd\")","\t\texecute(\"Body = Body & td & price\" & cstr(i) & \" & ctd\")","\t\texecute(\"Body = Body & td & amt\" & cstr(i) & \" & ctd\")","\t\texecute(\"Body = Body & td & formatnumber(total\" & cstr(i) & \",2) & ctd & ctr\")","\tend if ","Next","Body = Body & \"</table>\" & br","Body = Body & \"Grand total = \" & formatnumber(grandtotal,2) & br","","'prepare printed body test","","PrnBody = PrnBody & \"Catering Request \" & Vbcrlf & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Requestor name: \" & name & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Requestor email: \" & email & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Event Date: \" & rdate & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Event Time: \" & rtime & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Attendees: \" & attendees & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Group Name: \" & groupname & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Location: \" & location & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Setup type: \" & setuptype & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Department Charge Code: \" & deptchargecode & Vbcrlf & Vbcrlf ","PrnBody = PrnBody & \"Notes: \" & notes & Vbcrlf & Vbcrlf ","","For I = 1 to 23","\tif eval(\"amt\" &cstr(i)&\" > 0\") then","\t\tif eval(\"amt\" &cstr(i)&\" < 10\") then","\t\t\tExecute(\"PrnBody = PrnBody & \" & chr(34) & \"Quantity = 0\" & chr(34) & \" & amt\" & cstr(i) & \" & pipe\")","\t\telse","\t\t\tExecute(\"PrnBody = PrnBody & \" & chr(34) & \"Quantity = \"  & chr(34) & \" & amt\" & cstr(i) & \" & pipe\")\t\t","\t\tend if","\t\tExecute(\"PrnBody = PrnBody & desc\" & cstr(i) & \" & VbCrLf & VbCrLf\")","\t\t' PrnBody = PrnBody & \"Subtotal = \" & formatnumber(total1,2)  & VbCrLf & VbCrLf","\tend if","next","","PrnBody = PrnBody & VbCrLf & \"Total = $\" & formatnumber(grandtotal,2) & VbCrLf","","' Create FileSystem Object and Windows Script Host Network Object","'On Error Resume Next","","Set objFS = CreateObject(\"Scripting.FileSystemObject\")","Set objWSHNet = CreateObject(\"WScript.Network\")","","on error resume next","objWSHNet.RemovePrinterConnection \"LPT1:\"","objWSHNet.AddPrinterConnection \"LPT1:\", printer, False, strUsername, strPassword","Set objPrinter = objFS.CreateTextFile(\"LPT1:\", True)","'objPrinter.Write(PrnBody)","objPrinter.Write(Body)","Response.Write \"<br><font size='5'>Your catering order has been submitted and sent to the printer.</font><br>\"","","","' send email ","","if (name<>\"\") AND (rdate<>\"\") AND (email<>\"\") AND (deptchargecode<>\"\") THEN","\tSet mail = Server.CreateObject(\"CDO.Message\") ","\tmail.To = EmailTo","\tmail.From = EmailFrom","\tmail.Subject = Subject","\tmail.HTMLBody = Body","\tmail.Send()","\t' redirect to success page ","\t","\t' Close the print device object and trap for errors","\t'On Error Resume Next","\tobjPrinter.Close","\tobjWSHNet.RemovePrinterConnection \"LPT1:\"","\tSet objWSHNet  = Nothing","\tSet objFS      = Nothing","\tSet objPrinter = Nothing","","\tResponse.Write \"<br><font size='5'>An email containing your order has also been sent.</font><br>\"","ELSE","\tResponse.Write \"<br><font color='red' size='5'> Your catering order has not been submitted.</font><br>\"","end if","Response.Write br + Body","","%>",""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":260,"column":0},"end":{"row":261,"column":0}},"nl":"\n","lines":[""]}]}]]},"ace":{"folds":[],"scrolltop":2819,"scrollleft":0,"selection":{"start":{"row":198,"column":26},"end":{"row":198,"column":26},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":200,"state":"start","mode":"ace/mode/vbscript"}},"timestamp":1411676465386,"hash":"702d47c7a657aeb47d770ca1900bac56a0b6772c"}